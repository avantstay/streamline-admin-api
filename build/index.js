!function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},r.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=4)}([function(e,t){e.exports=require("path")},function(e,t){e.exports=require("fs")},function(e,t){e.exports=require("puppeteer")},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(o,u){function i(e){try{s(n.next(e))}catch(e){u(e)}}function a(e){try{s(n.throw(e))}catch(e){u(e)}}function s(e){e.done?o(e.value):new r(function(t){t(e.value)}).then(i,a)}s((n=n.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){var r,n,o,u,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return u={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u;function a(u){return function(a){return function(u){if(r)throw new TypeError("Generator is already executing.");for(;i;)try{if(r=1,n&&(o=n[2&u[0]?"return":u[0]?"throw":"next"])&&!(o=o.call(n,u[1])).done)return o;switch(n=0,o&&(u=[0,o.value]),u[0]){case 0:case 1:o=u;break;case 4:return i.label++,{value:u[1],done:!1};case 5:i.label++,n=u[1],u=[0];continue;case 7:u=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===u[0]||2===u[0])){i=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){i.label=u[1];break}if(6===u[0]&&i.label<o[1]){i.label=o[1],o=u;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(u);break}o[2]&&i.ops.pop(),i.trys.pop();continue}u=t.call(e,i)}catch(e){u=[6,e],n=0}finally{r=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,a])}}},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var a=u(r(2)),s=i(r(1)),c=i(r(0)),l="https://admin.streamlinevrs.com",p=function(e,t){return l+"/editor_email_company_document_template.html?template_id="+e+"&company_id="+t},f=function(){function e(e){var t=this;this.username=e.username,this.password=e.password,this.companyId=e.companyId,this.browser=a.default.launch({headless:!0}),this.page=this.browser.then(function(e){return n(t,void 0,void 0,function(){return o(this,function(t){switch(t.label){case 0:return[4,e.newPage()];case 1:return[2,t.sent()]}})})}).then(function(e){return n(t,void 0,void 0,function(){return o(this,function(t){switch(t.label){case 0:return[4,this.authenticate(e)];case 1:return[2,t.sent()]}})})})}return e.prototype.authenticate=function(e){return n(this,void 0,void 0,function(){return o(this,function(t){switch(t.label){case 0:return[4,e.goto("https://admin.streamlinevrs.com/auth_login.html?logout=1")];case 1:return t.sent(),[4,e.waitForSelector("#user_login")];case 2:return t.sent(),[4,e.type("#user_login",this.username)];case 3:return t.sent(),[4,e.type("#user_password",this.password)];case 4:return t.sent(),[4,e.click("#submit_button")];case 5:return t.sent(),[4,e.waitForSelector("#page_title_bar_title")];case 6:return t.sent(),[2,e]}})})},e.prototype.backupTemplate=function(e,t){return n(this,void 0,void 0,function(){var r,n;return o(this,function(o){switch(o.label){case 0:return[4,this.page];case 1:return[4,(r=o.sent()).goto(p(e,this.companyId))];case 2:return o.sent(),[4,r.waitForSelector("[title=Source]")];case 3:return o.sent(),[4,r.evaluate(function(){return document.querySelector("textarea[name=page_text]").value})];case 4:return n=o.sent(),s.writeFileSync(c.join(t,"template-"+e+".html"),n),[2]}})})},e.prototype.updateEmailTemplate=function(e,t){return n(this,void 0,void 0,function(){var r;return o(this,function(n){switch(n.label){case 0:return[4,this.page];case 1:return[4,(r=n.sent()).goto(p(e,this.companyId))];case 2:return n.sent(),[4,r.waitForSelector("[title=Source]")];case 3:return n.sent(),[4,r.click("[title=Source]")];case 4:return n.sent(),[4,r.waitFor(500)];case 5:return n.sent(),[4,r.evaluate(function(){return document.querySelector("textarea[role=textbox]").value=""})];case 6:return n.sent(),[4,r.type("textarea[role=textbox]",t)];case 7:return n.sent(),[4,r.click("[name=modify_button]")];case 8:return n.sent(),[4,r.waitForSelector(".tooltip")];case 9:return n.sent(),[2]}})})},e.prototype.updateHomeNetworkId=function(e,t){return n(this,void 0,void 0,function(){var r;return o(this,function(n){switch(n.label){case 0:return[4,this.page];case 1:return[4,(r=n.sent()).goto((o=e,l+"/edit_home.html?home_id="+o))];case 2:return n.sent(),[4,r.waitForSelector("input[name=property_variable_5028]")];case 3:return n.sent(),[4,r.evaluate(function(){return document.querySelector("[name=property_variable_5028]").value=""})];case 4:return n.sent(),[4,r.type("[name=property_variable_5028]",""+t)];case 5:return n.sent(),[4,r.click("[type=submit][name=modify_button]")];case 6:return n.sent(),[4,r.waitForSelector(".yui-dialog #yui-gen0-button")];case 7:return n.sent(),[4,r.click(".yui-dialog #yui-gen0-button")];case 8:return n.sent(),[4,r.waitFor(1e3)];case 9:return n.sent(),[4,r.waitForSelector("input[name=property_variable_5028]")];case 10:return n.sent(),[2]}var o})})},e.prototype.close=function(){return n(this,void 0,void 0,function(){return o(this,function(e){switch(e.label){case 0:return[4,this.browser];case 1:return[4,e.sent().close()];case 2:return e.sent(),[2]}})})},e}();t.default=f},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(r(3));t.default=o.default}]);